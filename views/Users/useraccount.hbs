<html lang="en">

   <body>
      <div class="page-wrapper">

         <main class="main">
            <div class="page-header text-center" style="background-image: url('/userAssets/images/page-header-bg.jpg')">
               <div class="container">
                  <h1 class="page-title">My Account<span>Shop</span></h1>
               </div><!-- End .container -->
            </div><!-- End .page-header -->
            <nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
               <div class="container">

               </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
               <div class="dashboard">
                  <div class="container">
                     <div class="row">
                        <aside class="col-md-2 col-lg-2">
                           <ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
                              <li class="nav-item">
                                 <a
                                    class="nav-link active"
                                    id="tab-dashboard-link"
                                    data-toggle="tab"
                                    href="#tab-dashboard"
                                    role="tab"
                                    aria-controls="tab-dashboard"
                                    aria-selected="true"
                                 >Dashboard</a>
                              </li>
                              <li class="nav-item">
                                 <a
                                    class="nav-link"
                                    id="tab-orders-link"
                                    data-toggle="tab"
                                    href="#tab-orders"
                                    role="tab"
                                    aria-controls="tab-orders"
                                    aria-selected="false"
                                 >Orders</a>
                              </li>
                              <li class="nav-item">
                                 <a
                                    class="nav-link"
                                    id="tab-downloads-link"
                                    data-toggle="tab"
                                    href="#tab-downloads"
                                    role="tab"
                                    aria-controls="tab-downloads"
                                    aria-selected="false"
                                 >Change Password</a>
                              </li>
                              <li class="nav-item">
                                 <a
                                    class="nav-link"
                                    id="tab-address-link"
                                    data-toggle="tab"
                                    href="#tab-address"
                                    role="tab"
                                    aria-controls="tab-address"
                                    aria-selected="false"
                                 >Adresses</a>
                              </li>
                              <li class="nav-item">
                                 <a
                                    class="nav-link"
                                    id="tab-account-link"
                                    data-toggle="tab"
                                    href="#tab-account"
                                    role="tab"
                                    aria-controls="tab-account"
                                    aria-selected="false"
                                 >Account Details</a>
                              </li>
                              <li class="nav-item">
                                 <a
                                    class="nav-link"
                                    id="tab-wallet-link"
                                    data-toggle="tab"
                                    href="#tab-wallet"
                                    role="tab"
                                    aria-controls="tab-wallet"
                                    aria-selected="false"
                                 >Wallet</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/logout">Sign Out</a>
                              </li>
                           </ul>
                        </aside><!-- End .col-lg-3 -->

                        <div class="col-md-10 col-lg-10">
                           <div class="tab-content">
                              <div
                                 class="tab-pane fade show active"
                                 id="tab-dashboard"
                                 role="tabpanel"
                                 aria-labelledby="tab-dashboard-link"
                              >
                                 {{!-- <p>Hello
                                    <span class="font-weight-normal text-dark">User</span>
                                    (not
                                    <span class="font-weight-normal text-dark">User</span>?
                                    <a href="#">Log out</a>)
                                    <br />
                                    From your account dashboard you can view your
                                    <a href="#tab-orders" class="tab-trigger-link link-underline">recent orders</a>, manage
                                    your
                                    <a href="#tab-address" class="tab-trigger-link">shipping and billing addresses</a>, and
                                    <a href="#tab-account" class="tab-trigger-link">edit your password and account details</a>.</p> --}}
                                    
                                            
                                 
                                 <!-- .End .tab-pane -->
                                 <div class=" d-flex justify-content-center">
                                    <img src="/images/AccountDetails.jpeg" style="width: 200px;" alt="">
                                 </div>
                                 <div class=" text-center">
                                    <div>
                                       <label class="fs-1">Name: <span class="text-primary">{{userdetails.name}}</span> </label>
                                    </div>
                                    <div>
                                       <label class="fs-1">Mobile: <span class="text-primary">{{userdetails.mobile}}</span></label>
                                    </div>
                                    <div>
                                        <label class="fs-1">Email: <span class="text-primary">{{userdetails.email}}</span></label>
                                    </div>
                                    <div>
                                       <label class="fs-1" >Referal Id: <span class="text-primary" id="myText">{{userdetails.referalcode}}</span><span><button onclick="copyContent()" class="ml-5 btn btn-outline-primary-2">Copy</button></span></label>
                                    </div>
                                 </div>
                                 
                                   
                                    
                              </div><!-- .End .tab-pane -->

                              <div class="tab-pane fade" id="tab-orders" role="tabpanel" aria-labelledby="tab-orders-link">

                                 <div class="page-content">
                                    <div class="cart">
                                       <div class="container-fluid">
                                          <div class="row w-100 d-flex justify-content-center">
                                             <div class="col-12 w-100">
                                                <table class="table table-cart table-borderless">
                                                   <thead>
                                                      <tr class="">
                                                         <th class="fs-3 fw-semibold">Order</th>
                                                         <th class="fs-3 fw-semibold">Date</th>
                                                         <th class="fs-3 fw-semibold">Total Amount</th>
                                                         <th class="fs-3 fw-semibold">Status</th>
                                                         <th class="fs-3 fw-semibold">Payment</th>
                                                         <th class="fs-3 fw-semibold"></th>
                                                      </tr>
                                                   </thead>
                                                   <tbody>
                                                      {{#each allOrders}}
                                                         <tr>
                                                            <td>
                                                               <p>#order{{this._id}}</p>
                                                            </td>
                                                            <td>
                                                               <p>{{this.timeoforder}}</p>
                                                            </td>
                                                            <td>
                                                               <p>Rs.{{this.grandTotal}}</p>
                                                            </td>
                                                            <td>
                                                               <p>{{this.status}}</p>
                                                            </td>
                                                            <td>
                                                               <p>{{this.paymentmethod}}</p>
                                                            </td>
                                                            <td>
                                                               <a
                                                                  onclick="orderDetails('{{this._id}}')"
                                                                  class="view text-primary fs-1"
                                                                  title="View Details"
                                                                  data-toggle="tooltip"
                                                               ><i class="material-icons">&#xE5C8;</i></a>
                                                            </td>
                                                         </tr>
                                                      {{/each}}
                                                   </tbody>

                                                </table><!-- End .table table-wishlist -->
                                             </div><!-- End .col-lg-9 -->

                                          </div><!-- End .row -->
                                       </div><!-- End .container -->
                                    </div><!-- End .cart -->
                                 </div><!-- End .page-content -->

                              </div><!-- .End .tab-pane -->

                              <div
                                 class="tab-pane fade"
                                 id="tab-downloads"
                                 role="tabpanel"
                                 aria-labelledby="tab-downloads-link"
                              >
                                 <form id="changepassword" action="#">
                                    

                                    <label>Current password (leave blank to leave unchanged)</label>
                                    <input type="password" name="currentpassword" class="form-control w-50" />

                                    <label>New password (leave blank to leave unchanged)</label>
                                    <input type="password" name="newpassword" class="form-control  w-50" />

                                    <label>Confirm new password</label>
                                    <input type="password" name="retypepassword" class="form-control mb-2  w-50" />

                                    <button type="submit" class="btn btn-outline-primary-2">
                                       <span>SAVE CHANGES</span>
                                       <i class="icon-long-arrow-right"></i>
                                    </button>
                                 </form>
                              </div><!-- .End .tab-pane -->

                              <div
                                 class="tab-pane fade"
                                 id="tab-wallet"
                                 role="tabpanel"
                                 aria-labelledby="tab-wallet-link"
                              >
                                 <div class="d-flex align-items-end justify-content-end m-5">
                                    <div >
                                       <img style="width: 80px;" src="/images/wallet.png" alt="">
                                    </div>
                                     <p class="fs-2 ms-2">Wallet: <span class=" fs-1 text-success"> {{wallet.Balance}}</span></p>
                                 </div>
                                
                                 
                                 <div class="page-content">
                                    <div class="cart">
                                       <div class="container-fluid">
                                          <div class="row w-100 d-flex justify-content-center">
                                             <div class="col-12 w-100">
                                                <table class="table table-cart table-borderless">
                                                   <thead>
                                                      <tr class="">
                                                         
                                                         <th class="fs-3 fw-semibold">Date</th>
                                                         <th class="fs-3 fw-semibold">Time</th>
                                                         <th class="fs-3 fw-semibold">OldBalance</th>
                                                         <th class="fs-3 fw-semibold">Credit</th>
                                                         <th class="fs-3 fw-semibold">Debit</th>
                                                         <th class="fs-3 fw-semibold">NewBalance</th>
                                                      </tr>
                                                   </thead>
                                                   <tbody>
                                                      {{#each wallet.transactions}}
                                                         <tr>
                                                            <td>
                                                               <p class="fs-3">{{this.date}}</p>
                                                            </td>
                                                            <td>
                                                               <p class="fs-3">{{this.time}}</p>
                                                            </td>
                                                            <td>
                                                               <p class="fs-3">Rs.{{this.oldbalance}}</p>
                                                            </td>
                                                            <td>
                                                               {{#if (isZero this.credit)}}
                                                               -
                                                               {{else}}
                                                               <p class="text-success fs-3">+{{this.credit}}</p>
                                                               {{/if}}
                                                            </td>
                                                            <td>
                                                               {{#if (isZero this.debit)}}
                                                               -
                                                               {{else}}
                                                               <p class="text-danger fs-3">-{{this.debit}}</p>
                                                               {{/if}}
                                                            </td>
                                                            <td>
                                                               <p class="text-primary fs-3">Rs. {{this.newbalance}}</p>
                                                            </td>
                                                            
                                                         </tr>
                                                      {{/each}}
                                                   </tbody>

                                                </table><!-- End .table table-wishlist -->
                                             </div><!-- End .col-lg-9 -->

                                          </div><!-- End .row -->
                                       </div><!-- End .container -->
                                    </div><!-- End .cart -->
                                 </div><!-- End .page-content -->
                              </div><!-- .End .tab-pane -->

                              <div
                                 class="tab-pane fade"
                                 id="tab-address"
                                 role="tabpanel"
                                 aria-labelledby="tab-address-link"
                              >
                                 <p></p>

                                 <div class="row">

                                    {{#each address}}
                                       <div id="{{this._id}}" class="m-3 d-flex justify-content-evenly f" >
                                          <div class="f w-50 d-flex align-items-center col-12 col-md-6">
                                             <label class="f" for="">{{this.housenumberorstreetname}}</label>
                                          </div>
                                          <div class="d-flex">
                                             <a
                                                class="mt-1 me-4"
                                                onclick="getAddress('{{this._id}}')"
                                             ><img style="width: 2em;" src="/images/pen.png" alt=""></a>
                                             <a onclick="deleteAddress('{{this._id}}')"><img style="width:3em" src="/images/trash.png" alt=""></a>
                                          </div>
                                       </div>
                                    {{/each}}

                                    <div
                                       class="modal fade"
                                       id="editModal"
                                       tabindex="-1"
                                       role="dialog"
                                       aria-labelledby="exampleModalLabel"
                                       aria-hidden="true"
                                    >
                                       <div class="modal-dialog" role="document">
                                          <div class="modal-content">
                                             <div class="mt-3">
                                                <h5 class="text-center fs-3">Edit Address</h5>
                                             </div>
                                             <form id="editaddress-form">
                                                <div class="row mx-1">

                                                   <div style="display: none;" class="col-12 col-sm-6">
                                                      {{#if user}}
                                                         <input
                                                            type="text"
                                                            hidden
                                                            name="userId"
                                                            value="{{user}}"
                                                            class="form-control"
                                                            placeholder="User Id  "
                                                            required
                                                         />
                                                      {{/if}}

                                                   </div><!-- End .col-sm-6 -->

                                                   <div style="display: none;" class="col-12 col-sm-6">
                                                      
                                                         <input
                                                            type="text"
                                                            id="addressid"
                                                            hidden
                                                            name="addressId"
                                                            value=""
                                                            class="form-control"
                                                            placeholder="Address Id"
                                                            required
                                                         />
                                                      

                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12 col-sm-6">

                                                      <input
                                                         type="text"
                                                         id="firstName"
                                                         name="firstname"
                                                         class="form-control"
                                                         placeholder="First Name"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12 col-sm-6">
                                                      <input
                                                         type="text"
                                                         id="lastName"
                                                         name="lastname"
                                                         class="form-control"
                                                         placeholder="Last Name"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12">
                                                      <input
                                                         id="companyName"
                                                         type="text"
                                                         name="companyname"
                                                         class="form-control"
                                                         placeholder="Company name (optional)"
                                                      />
                                                   </div>

                                                   <div class="col-12">
                                                      <input
                                                         id="country"
                                                         type="text"
                                                         name="country"
                                                         class="form-control"
                                                         required
                                                         placeholder="Country"
                                                      />
                                                   </div>

                                                   <div class="col-12">
                                                      <input
                                                         id="housenumberORStreetname"
                                                         type="text"
                                                         class="form-control"
                                                         name="housenumberORStreetname"
                                                         placeholder="House number and Street name"
                                                         required
                                                      />
                                                      <input
                                                         id="appartment"
                                                         type="text"
                                                         class="form-control"
                                                         name="appartment"
                                                         placeholder="Appartments, suite, unit etc ..."
                                                         required
                                                      />
                                                   </div>

                                                   <div class="col-12 col-sm-6">
                                                      <input
                                                         id="townorcity"
                                                         type="text"
                                                         name="townORcity"
                                                         class="form-control"
                                                         placeholder="Town/City"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12 col-sm-6">
                                                      <input
                                                         id="stateorcounty"
                                                         type="text"
                                                         name="stateORcounty"
                                                         class="form-control"
                                                         placeholder="State/County"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12 col-sm-6">
                                                      <input
                                                         id="postal"
                                                         type="text"
                                                         name="postalcode"
                                                         class="form-control"
                                                         placeholder="Postal Code"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12 col-sm-6">
                                                      <input
                                                         id="phone"
                                                         type="tel"
                                                         name="phone"
                                                         class="form-control"
                                                         placeholder="Phone"
                                                         required
                                                      />
                                                   </div><!-- End .col-sm-6 -->

                                                   <div class="col-12">
                                                      <input
                                                         id="email"
                                                         type="email"
                                                         name="email"
                                                         class="form-control"
                                                         placeholder="Email"
                                                         required
                                                      />
                                                   </div>

                                                   <div class="d-flex justify-content-center">
                                                      <button class="btn btn-danger m-4" data-dismiss="modal">Cancel</button>
                                                      <button type="submit" class="btn btn-success m-4" >Save Changes</button>
                                                   </div>

                                                </div>
                                             </form>
                                          </div>
                                       </div>
                                    </div>

                                 </div><!-- End .row -->
                              </div><!-- .End .tab-pane -->

                              <div
                                 class="tab-pane fade"
                                 id="tab-account"
                                 role="tabpanel"
                                 aria-labelledby="tab-account-link"
                              >

                                  <label>Referal Code *</label>
                                    <input type="text" disabled value="{{userdetails.referalcode}}" class="form-control" required />
                                 <form action="#" id="accountDetails">

                                   
                                    
                                    <div class="col-sm-6">
                                       <label>First Name *</label>
                                       <input type="text" name="firstname" value="{{userdetails.name}}" class="form-control" required />
                                    </div><!-- End .col-sm-6 -->

                                    <label>Mobile Number *</label>
                                    <input type="number" name="mobilenumber" value="{{userdetails.mobile}}" class="form-control" required />
                                   
                                    <label>Email address *</label>
                                    <input type="email" name="email" value="{{userdetails.email}}" class="form-control" required />

                                    <button type="submit" class="btn btn-outline-primary-2">
                                       <span>SAVE CHANGES</span>
                                       <i class="icon-long-arrow-right"></i>
                                    </button>
                                 </form>
                              </div><!-- .End .tab-pane -->
                           </div>
                        </div><!-- End .col-lg-9 -->
                     </div><!-- End .row -->
                  </div><!-- End .container -->
               </div><!-- End .dashboard -->
            </div><!-- End .page-content -->
         </main><!-- End .main -->

         
      </div><!-- End .page-wrapper -->
      <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

      <!-- Mobile Menu -->
      <div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->

      

      <!-- Plugins JS File -->
      <script src="/userAssets/js/jquery.min.js"></script>
      <script src="/userAssets/js/bootstrap.bundle.min.js"></script>
      <script src="/userAssets/js/jquery.hoverIntent.min.js"></script>
      <script src="/userAssets/js/jquery.waypoints.min.js"></script>
      <script src="/userAssets/js/superfish.min.js"></script>
      <script src="/userAssets/js/owl.carousel.min.js"></script>
      <!-- Main JS File -->
      <script src="/userAssets/js/main.js"></script>
   </body>

   <!-- molla/dashboard.html  22 Nov 2019 10:03:13 GMT -->
</html>

<script>
  $('#editaddress-form').submit((e)=>{
    e.preventDefault()
    $.ajax({
      url:'/edit-address',
      type:'post',
      data:$('#editaddress-form').serialize(),
      success:(reponse)=>{
        swal("Success!", "You address changed successfully!", "success").then(()=>{
          location.reload()
        })
        
      },
			error:(response)=>{
				location.href = '/error'
			}
    })
  })

  $('#changepassword').submit((e)=>{
    e.preventDefault()
    $.ajax({
      url:'/changepassword',
      type:'post',
      data:$('#changepassword').serialize(),
      success:(response)=>{
         if(response.status){
            swal("Success!", "You password changed successfully!", "success").then(()=>{
               location.reload()
            })
         }else{
            swal("Ops!", response.message, "error").then(()=>{
                  location.reload()
            })
         }
      },
			error:(response)=>{
				location.href = '/error'
			}
    })
  })

  $('#accountDetails').submit((e)=>{
   e.preventDefault()
   $.ajax({
      url:'/changeaccountdetails',
      type:'put',
      data:$('#accountDetails').serialize(),
      success:(response)=>{
         if(response.status){
            swal(response.message,"",'success')
         }else{
            swal(response.message,"",'error')
         }
      },
			error:(response)=>{
				location.href = '/error'
			}
   })
  })


  let text = document.getElementById('myText').innerHTML;
  let copyContent = async () => {
   swal("Referal code copied to clipboard","","success")
    try {
      await navigator.clipboard.writeText(text);
      console.log('Content copied to clipboard');
    } catch (err) {
      console.error('Failed to copy: ', err);
    }
  }
</script>